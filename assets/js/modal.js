function showModal(title,content,actions,clazz,centered,type){var container=$('<div>').attr('class','modalContainer');if(typeof clazz!=='undefined'&&clazz){container.addClass(clazz);}
var overlay=$('<div>').attr('class','modalOverlay');container.append(overlay);var modal=$('<div>').attr('class','modal');if(typeof type!=='undefined'&&type!==''){modal.attr('data-modal',type);}
var modalContent=$('<div>').attr('class','modalContent');if(title!==undefined&&title!==null&&title){var header=$('<div>').attr('class','modalHeader');var modalTitle=$('<div>').attr('class','modalTitle').text(title);header.append(modalTitle);var modalClose=$('<div>').attr('class','modalClose').one('click',closeModals);header.append(modalClose);modalContent.append(header);}else{var modalClose=$('<div>').attr('class','modalClose').one('click',closeModals);modalContent.append(modalClose);}
var body=$('<div>').attr('class','modalBody');var bodyContent=$('<div>').attr('class','modalCorpus').append(content);if(typeof centered==='undefined'||centered===true){bodyContent.addClass('centered');}
body.append(bodyContent);if(actions&&actions.length>0){var actionsContainer=$('<div>').attr('class','modalActions');for(var i=0;i<actions.length;i++){var act=actions[i];var action=$('<a>').append(act.label).data('function',act.action);action.on('click',function(e){if(!$(e.target).hasClass('disabled')){var el=$(this);var fun=el.data('function');fun(modal,el);if(typeof act.doOnce!=='undefined'&&act.doOnce){el.unbind('click');}}});if(act.primary){action.addClass('button primary');}else if(act.secondary){action.addClass('button tertiary');}else{action.addClass('button');}
actionsContainer.append(action);}
body.append(actionsContainer);}
modalContent.append(body);modal.append(modalContent);container.append(modal);$('body').append(container);setTimeout(function(){$('html').on('mousedown.modal',function(event){var target=$(event.target);if(!target.is('.modal')&&target.closest('.modal').length===0&&(!target.is('.featureRequestAutocomplete')&&target.closest('.featureRequestAutocomplete').length===0)){closeModals();$('html').unbind('mousedown.modal');}});},300);return container;}
function showMergeModal(){var title='Merge your accounts';var content=$('<div>').append('Merge from ').append($('<input>').attr('type','text').attr('name','email').attr('placeholder','enter your other email here')).append(' to this account');var actions=[{label:'Merge accounts',primary:true,action:function(modal,button){var email=modal.find('input[name="email"]').val().trim();button.replaceWith($('<span>').text('Sent confirmation email to '+email));$.ajax({url:'mergeUser',type:'POST',data:{email:email,_csrfToken:_csrfToken}});}}];showModal(title,content,actions);}
function showModalAlert(content,clazz){var actions=[{label:'Ok',primary:true,action:closeModals}];showModal('',content,actions,clazz);}
function showModalConfirm(title,content,callback,doOnce){if(typeof content==='undefined'||typeof content!=='string'){callback=content;content=title;title='';}
var actions=[{label:'Cancel',action:closeModals},{label:'Accept',primary:true,doOnce:doOnce,action:function(){try{callback();}catch(e){}
closeModals();}}];showModal(title,content,actions,'confirmation');}
function closeModals(callback){$('.modalContainer').fadeOut('fast',function(){$(this).remove();if(typeof callback!=='undefined'&&$.isFunction(callback)){callback();}}).trigger('modalClose');$('html').unbind('mousedown.modal');}