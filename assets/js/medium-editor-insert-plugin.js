(function(v){"function"===typeof define&&define.amd?define(["jquery","handlebars/runtime","medium-editor","blueimp-file-upload","jquery-sortable"],v):"object"===typeof module&&module.exports?module.exports=function(r){if("undefined"===typeof window)throw Error("medium-editor-insert-plugin runs only in a browser.");void 0===r&&(r=require("jquery"));window.jQuery=r;Handlebars=require("handlebars/runtime");MediumEditor=require("medium-editor");require("jquery-sortable");require("blueimp-file-upload");v(r,Handlebars,MediumEditor);return r}:v(jQuery,Handlebars,MediumEditor)})(function(v,r,u){this.MediumInsert=this.MediumInsert||{};this.MediumInsert.Templates=this.MediumInsert.Templates||{};this.MediumInsert.Templates["src/js/templates/core-buttons.hbs"]=r.template({1:function(a,f,m,q,h){var g,d;q=null!=f?f:{};var b=m.helperMissing;a=a.escapeExpression((d=null!=(d=m.key||h&&h.key)?d:b,"function"===typeof d?d.call(q,{name:"key",hash:{},data:h}):d));return'            <li data-button="'+a.toLowerCase()+
'"><button data-addon="'+a+'" data-action="add" class="medium-insert-action" type="button">'+(null!=(g=(d=null!=(d=m.label||(null!=f?f.label:f))?d:b,"function"===typeof d?d.call(q,{name:"label",hash:{},data:h}):d))?g:"")+"</button></li>\n"},compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g;return'<div class="medium-insert-buttons" contenteditable="false"><ul class="medium-insert-buttons-addons">'+(null!=(g=m.each.call(null!=f?f:{},null!=f?f.addons:f,{name:"each",hash:{},fn:a.program(1,h,0),inverse:a.noop,data:h}))?g:"")+"    </ul>\n</div>\n"},useData:!0});this.MediumInsert.Templates["src/js/templates/core-caption.hbs"]=r.template({compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g;return'<figcaption contenteditable="true" class="medium-insert-caption-placeholder" data-placeholder="'+a.escapeExpression((g=null!=(g=m.placeholder||(null!=f?f.placeholder:f))?g:m.helperMissing,"function"===typeof g?g.call(null!=f?f:{},{name:"placeholder",hash:{},data:h}):g))+'"></figcaption>'},useData:!0});this.MediumInsert.Templates["src/js/templates/core-empty-line.hbs"]=r.template({compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){return"<p><br></p>\n"},useData:!0});this.MediumInsert.Templates["src/js/templates/embeds-toolbar.hbs"]=r.template({1:function(a,f,m,q,h){var g;return'    <div class="medium-insert-embeds-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(g=m.each.call(null!=f?f:{},null!=f?f.styles:f,{name:"each",hash:{},fn:a.program(2,h,0),inverse:a.noop,data:h}))?g:"")+"        </ul>\n    </div>\n"},2:function(a,f,m,q,h){var g;return null!=(g=m["if"].call(null!=f?f:{},null!=f?f.label:f,{name:"if",hash:{},fn:a.program(3,h,0),inverse:a.noop,data:h}))?g:""},3:function(a,f,m,q,h){var g,d;q=null!=f?f:{};var b=m.helperMissing;a=a.escapeExpression((d=null!=(d=m.key||h&&h.key)?d:b,"function"===typeof d?d.call(q,{name:"key",hash:{},data:h}):d));var c=null!=(g=(d=null!=(d=m.name||(null!=f?f.name:f))?d:b,"function"===typeof d?d.call(q,{name:"name",hash:{},data:h}):d))?g:"";return'                    <li data-button="'+a.toLowerCase()+'"'+(c?' class="tooltippable" data-tooltip-title="'+c+'" data-tooltip-container=".feature"':"")+'>\n                        <button class="medium-editor-action" data-action="'+a+'">'+(null!=(g=(d=null!=(d=m.label||(null!=f?f.label:f))?d:b,"function"===typeof d?d.call(q,{name:"label",hash:{},data:h}):d))?g:"")+"</button>\n                    </li>\n"},5:function(a,f,m,q,h){var g;return'    <div class="medium-insert-embeds-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n        <ul class="medium-editor-toolbar-actions clearfix">\n'+
(null!=(g=m.each.call(null!=f?f:{},null!=f?f.actions:f,{name:"each",hash:{},fn:a.program(2,h,0),inverse:a.noop,data:h}))?g:"")+"        </ul>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g;q=null!=f?f:{};return(null!=(g=m["if"].call(q,null!=f?f.styles:f,{name:"if",hash:{},fn:a.program(1,h,0),inverse:a.noop,data:h}))?g:"")+"\n"+(null!=(g=m["if"].call(q,null!=f?f.actions:f,{name:"if",hash:{},fn:a.program(5,h,0),inverse:a.noop,data:h}))?g:"")},useData:!0});this.MediumInsert.Templates["src/js/templates/embeds-wrapper.hbs"]=r.template({compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g,d;return'<div class="medium-insert-embeds" contenteditable="false" data-url="'+(null!=(g=(d=null!=(d=m.url||(null!=f?f.url:f))?d:m.helperMissing,"function"===typeof d?d.call(null!=f?f:{},{name:"url",hash:{},data:h}):d))?g:"")+'">\n\t<figure>\n\t\t<div class="medium-insert-embed">\n\t\t\t'+(null!=(g=(d=null!=(d=m.html||(null!=f?f.html:f))?d:m.helperMissing,"function"===typeof d?d.call(null!=f?f:{},{name:"html",hash:{},data:h}):d))?g:"")+'\n\t\t</div>\n\t</figure>\n\t<div class="medium-insert-embeds-overlay"></div>\n</div>'},useData:!0});this.MediumInsert.Templates["src/js/templates/images-fileupload.hbs"]=r.template({compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){return'<input type="file" multiple accept="image/*">'},useData:!0});this.MediumInsert.Templates["src/js/templates/images-image.hbs"]=r.template({1:function(a,f,m,q,h){return'        <div class="medium-insert-images-progress"></div>\n'},compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g,d;q=null!=f?f:{};return'<figure contenteditable="false">\n    <img src="'+a.escapeExpression((d=null!=(d=m.img||(null!=f?f.img:f))?d:m.helperMissing,"function"===typeof d?d.call(q,{name:"img",hash:{},data:h}):d))+'" alt="" />\n'+(null!=(g=m["if"].call(q,null!=f?f.progress:f,{name:"if",hash:{},fn:a.program(1,h,0),inverse:a.noop,data:h}))?g:"")+"</figure>\n"},useData:!0});this.MediumInsert.Templates["src/js/templates/images-progressbar.hbs"]=r.template({compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){return'<progress min="0" max="100" value="0">0</progress>'},useData:!0});this.MediumInsert.Templates["src/js/templates/images-toolbar.hbs"]=r.template({1:function(a,f,m,q,h){var g;return null!=(g=m["if"].call(null!=f?f:{},null!=f?f.label:f,{name:"if",hash:{},fn:a.program(2,h,0),inverse:a.noop,data:h}))?g:""},2:function(a,f,m,q,h){var g,d;q=null!=f?f:{};var b=m.helperMissing;a=a.escapeExpression((d=null!=(d=m.key||h&&h.key)?d:b,"function"===typeof d?d.call(q,{name:"key",hash:{},data:h}):d));return'                <li data-button="'+a+'">\n                    <button class="medium-editor-action" data-action="'+a+'">'+(null!=(g=(d=null!=(d=m.label||(null!=f?f.label:f))?d:b,"function"===typeof d?d.call(q,{name:"label",hash:{},data:h}):d))?g:"")+"</button>\n                </li>\n"},4:function(a,f,m,q,h){var g;return'\t<div class="medium-insert-images-toolbar2 medium-editor-toolbar medium-editor-toolbar-active">\n\t\t<ul class="medium-editor-toolbar-actions clearfix">\n'+(null!=(g=m.each.call(null!=f?f:{},null!=f?f.actions:f,{name:"each",hash:{},fn:a.program(5,h,0),inverse:a.noop,data:h}))?g:"")+"    \t</ul>\n    </div>\n"},5:function(a,f,m,q,h){var g;return null!=(g=m["if"].call(null!=f?f:{},null!=f?f.label:f,{name:"if",hash:{},fn:a.program(6,h,0),inverse:a.noop,data:h}))?g:""},6:function(a,f,m,q,h){var g,d;q=null!=f?f:{};var b=m.helperMissing;a=a.escapeExpression((d=null!=(d=m.key||h&&h.key)?d:b,"function"===typeof d?d.call(q,{name:"key",hash:{},data:h}):d));return'        \t        <li data-button="'+
a+'">\n        \t            <button class="medium-editor-action" data-action="'+a+'">'+(null!=(g=(d=null!=(d=m.label||(null!=f?f.label:f))?d:b,"function"===typeof d?d.call(q,{name:"label",hash:{},data:h}):d))?g:"")+"</button>\n        \t        </li>\n"},compiler:[7,">= 4.0.0"],main:function(a,f,m,q,h){var g;q=null!=f?f:{};return'<div class="medium-insert-images-toolbar medium-editor-toolbar medium-toolbar-arrow-under medium-editor-toolbar-active">\n    <ul class="medium-editor-toolbar-actions clearfix">\n'+
(null!=(g=m.each.call(q,null!=f?f.styles:f,{name:"each",hash:{},fn:a.program(1,h,0),inverse:a.noop,data:h}))?g:"")+"    </ul>\n</div>\n\n"+(null!=(g=m["if"].call(q,null!=f?f.actions:f,{name:"if",hash:{},fn:a.program(4,h,0),inverse:a.noop,data:h}))?g:"")},useData:!0});(function(a,f,m,q){function h(b){return b.charAt(0).toUpperCase()+b.slice(1)}function g(b,c){this.el=b;this.$el=a(b);this.templates=f.MediumInsert.Templates;if(c)var e=c.editor;this.options=a.extend(!0,{},d,c);this.options.editor=e;this._defaults=d;this._name="mediumInsert";this.options&&this.options.editor&&(this.options.editor._serialize===q&&(this.options.editor._serialize=this.options.editor.serialize),this.options.editor._destroy===q&&(this.options.editor._destroy=this.options.editor.destroy),this.options.editor._setup===q&&(this.options.editor._setup=this.options.editor.setup),this.options.editor._hideInsertButtons=this.hideButtons,this.options.editor.serialize=this.editorSerialize,this.options.editor.destroy=this.editorDestroy,this.options.editor.setup=this.editorSetup,this.options.editor.getExtensionByName("placeholder")!==q&&(this.options.editor.getExtensionByName("placeholder").updatePlaceholder=this.editorUpdatePlaceholder))}var d={editor:null,enabled:!0,addons:{images:!0,embeds:!0}};g.prototype.init=function(){this.$el.addClass("medium-editor-insert-plugin");"object"===typeof this.options.addons&&0!==Object.keys(this.options.addons).length||this.disable();this.initAddons();this.clean();this.events();this.positionButtons();var b=this.$el.find("p:not(.medium-insert-buttons)").last();0<b.length&&""===b.html().trim()&&b.append("<br>")};g.prototype.events=function(){var b=this;this.$el.on("dragover drop",function(c){c.preventDefault()}).on("keyup click",a.proxy(this,"toggleButtons")).on("selectstart mousedown",".medium-insert, .medium-insert-buttons",a.proxy(this,"disableSelection")).on("click",".medium-insert-buttons-show",a.proxy(this,"toggleAddons")).on("paste",".medium-insert-caption-placeholder",function(c){a.proxy(b,"removeCaptionPlaceholder")(a(c.target))});this.getButtonsContainer().find(".medium-insert-buttons").unbind("click").on("click",".medium-insert-action",a.proxy(this,"addonAction"));a(f).on("resize",a.proxy(this,"positionButtons",null))};g.prototype.getEditor=function(){return this.options.editor};g.prototype.editorSerialize=function(){var b=this._serialize();a.each(b,function(c){var e=a("<div />").html(b[c].value);e.find(".medium-insert-buttons").remove();e.find(".medium-insert-active").removeClass("medium-insert-active");e.find("[data-embed-code]").each(function(){var k=a(this),l=a("<div />").html(k.attr("data-embed-code")).text();k.html(l)});b[c].value=e.html()});return b};g.prototype.editorDestroy=function(){a.each(this.elements,function(b,c){a(c).data("plugin_mediumInsert")instanceof g&&a(c).data("plugin_mediumInsert").disable()});this._destroy()};g.prototype.editorSetup=function(){this._setup();a.each(this.elements,function(b,c){a(c).data("plugin_mediumInsert")instanceof g&&a(c).data("plugin_mediumInsert").enable()})};g.prototype.editorUpdatePlaceholder=function(b,c){var e=a(b).children().not(".medium-insert-buttons").contents();c||1!==e.length||"br"!==e[0].nodeName.toLowerCase()?this.hidePlaceholder(b):(this.showPlaceholder(b),this.base._hideInsertButtons(a(b)))};g.prototype.triggerInput=function(){this.getEditor()&&this.getEditor().trigger("editableInput",null,this.el)};g.prototype.deselect=function(){m.getSelection().removeAllRanges()};g.prototype.disable=function(){this.options.enabled=!1;this.getButtonsContainer().find(".medium-insert-buttons").addClass("hide")};g.prototype.enable=function(){this.options.enabled=!0;this.clean();this.getButtonsContainer().find(".medium-insert-buttons").removeClass("hide")};g.prototype.disableSelection=function(b){var c=a(b.target);(!1===c.is("img")||c.hasClass("medium-insert-buttons-show"))&&b.preventDefault()};g.prototype.initAddons=function(){var b=this;this.options.addons&&0!==this.options.addons.length&&a.each(this.options.addons,function(c,e){var k="mediumInsert"+h(c);!1===e?delete b.options.addons[c]:(b.$el[k](e),b.options.addons[c]=b.$el.data("plugin_"+k).options)})};g.prototype.clean=function(){var b=this;if(!1!==this.options.enabled){0===this.$el.children().length&&this.$el.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim());this.$el.contents().filter(function(){return"#text"===this.nodeName&&""!==a.trim(a(this).text())||"br"===this.nodeName.toLowerCase()}).each(function(){a(this).wrap("<p />");b.moveCaret(a(this).parent(),a(this).text().length)});this.addButtons();var c=this.getButtonsContainer().find(".medium-insert-buttons");var e=c.prev();e.attr("class")&&e.attr("class").match(/medium\-insert(?!\-active)/)&&c.before(this.templates["src/js/templates/core-empty-line.hbs"]().trim())}};g.prototype.getButtons=function(){if(!1!==this.options.enabled)return this.templates["src/js/templates/core-buttons.hbs"]({addons:this.options.addons}).trim()};g.prototype.getButtonsContainer=function(){return"undefined"!==typeof this.options.editorContainer&&"undefined"!==this.options.buttonsContainer?this.$el.closest(this.options.editorContainer).find(this.options.buttonsContainer):this.$el};g.prototype.getActiveElement=function(){};g.prototype.addButtons=function(){var b=this.getButtonsContainer(),c=this.getButtons();0===b.find("."+a(c).attr("class")).length&&b.append(c)};g.prototype.toggleButtons=function(b){var c=a(b.target);b=f.getSelection();var e=this,k,l;if(!1!==this.options.enabled){if(b&&0!==b.rangeCount){b=b.getRangeAt(0);var n=a(b.commonAncestorContainer)}else n=c;n.hasClass("medium-editor-insert-plugin")&&(n=n.find("p:first"));(k=n.is("p")?n:n.closest("p"))&&0!==k.length||(k=n.closest(".medium-editor-element > div"));this.clean();!1===c.hasClass("medium-editor-placeholder")&&0===c.closest(".medium-insert-buttons").length&&0===n.closest(".medium-insert-buttons").length&&(this.$el.find(".medium-insert-active").removeClass("medium-insert-active"),a.each(this.options.addons,function(p){c.closest(".medium-insert-"+p).length&&(n=c);n.closest(".medium-insert-"+p).length&&(k=n.closest(".medium-insert-"+p),l=p)}),!k.length||l&&"images"!==l?this.hideButtons():(k.addClass("medium-insert-active"),"images"===l?this.getButtonsContainer().find(".medium-insert-buttons").attr("data-active-addon",l):this.getButtonsContainer().find(".medium-insert-buttons").removeAttr("data-active-addon"),setTimeout(function(){e.positionButtons(l);e.showButtons(l)},l?100:0)))}};g.prototype.showButtons=function(b){var c=this.getButtonsContainer().find(".medium-insert-buttons");c.show();c.find("li").show();"undefined"!==typeof this.options.buttonsContainer||"undefined"!==typeof this.options.toolbar.static&&this.options.toolbar.static||!b||(c.find("li").hide(),c.find('button[data-addon="'+b+'"]').parent().show())};g.prototype.hideButtons=function(b){"undefined"!==typeof this.options.buttonsContainer||"undefined"!==typeof this.options.toolbar.static&&this.options.toolbar.static||(b=b||this.$el,this.getButtonsContainer().find(".medium-insert-buttons").hide(),b.find(".medium-insert-buttons-addons").hide(),b.find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate"))};g.prototype.positionButtons=function(b){var c=this.getButtonsContainer().find(".medium-insert-buttons"),e=this.$el.find(".medium-insert-active"),k=e.hasClass("medium-insert-images-grid")?[]:e.find("figure:last figcaption"),l=this.getEditor()?this.getEditor().options.elementsContainer:a("body").get(0),n=-1<["absolute","fixed"].indexOf(f.getComputedStyle(l).getPropertyValue("position")),p={};e.length||(e=this.$el.find("p,div").not(".medium-insert-buttons").last());e.length&&(p.left=e.position().left,p.top=e.position().top,b?(p.left+=e.width()-
c.find(".medium-insert-buttons-show").width()-10,p.top+=e.height()-20+(k.length?-k.height()-parseInt(k.css("margin-top"),10):10)):(p.left+=-parseInt(c.find(".medium-insert-buttons-addons").css("left"),10)-parseInt(c.find(".medium-insert-buttons-addons button:first").css("margin-left"),10),p.top+=parseInt(e.css("margin-top"),10)),n&&(p.top+=l.scrollTop),!1===this.$el.hasClass("medium-editor-placeholder")&&0>p.left&&(p.left=e.position().left),c.css(p))};g.prototype.toggleAddons=function(){"images"===this.getButtonsContainer().find(".medium-insert-buttons").attr("data-active-addon")?this.getButtonsContainer().find(".medium-insert-buttons").find('button[data-addon="images"]').click():(this.getButtonsContainer().find(".medium-insert-buttons-addons").fadeToggle(),this.getButtonsContainer().find(".medium-insert-buttons-show").toggleClass("medium-insert-buttons-rotate"))};g.prototype.hideAddons=function(){"undefined"!==typeof this.options.buttonsContainer||"undefined"!==typeof this.options.toolbar.static&&this.options.toolbar.static||(this.getButtonsContainer().find(".medium-insert-buttons-addons").hide(),this.getButtonsContainer().find(".medium-insert-buttons-show").removeClass("medium-insert-buttons-rotate"))};g.prototype.addonAction=function(b){if(0===this.$el.find(".medium-insert-active").length){var c=this.$el.children("p:not(.medium-insert-buttons)").last();c.length&&(c.hasClass("medium-insert-active")||c.addClass("medium-insert-active"),this.getEditor().selectElement(c[0]))}c=a(b.currentTarget);b=c.data("addon");c=c.data("action");this.$el.data("plugin_mediumInsert"+h(b))[c]()};g.prototype.moveCaret=function(b,c){c=c||0;var e=m.createRange();var k=f.getSelection();b=b.get(0);if(!b.childNodes.length){var l=m.createTextNode(" ");b.appendChild(l)}e.setStart(b.childNodes[0],c);e.collapse(!0);k.removeAllRanges();k.addRange(e)};g.prototype.addCaption=function(b,c){0===b.find("figcaption").length&&b.append(this.templates["src/js/templates/core-caption.hbs"]({placeholder:c}))};g.prototype.removeCaptions=function(b){var c=this.$el.find("figcaption");b&&(c=c.not(b));c.each(function(){(a(this).hasClass("medium-insert-caption-placeholder")||""===a(this).text().trim())&&a(this).remove()})};g.prototype.removeCaptionPlaceholder=function(b){b=b.is("figcaption")?b:b.find("figcaption");b.length&&b.removeClass("medium-insert-caption-placeholder").removeAttr("data-placeholder")};a.fn.mediumInsert=function(b){return this.each(function(){var c=this;if(a(c).is("textarea")){var e=a(c).attr("medium-editor-textarea-id");c=a(c).siblings('[medium-editor-textarea-id="'+e+'"]').get(0)}if(!a.data(c,"plugin_mediumInsert"))a.data(c,"plugin_mediumInsert",new g(c,b)),a.data(c,"plugin_mediumInsert").init();else if("string"===typeof b&&a.data(c,"plugin_mediumInsert")[b])a.data(c,"plugin_mediumInsert")[b]()})}})(jQuery,window,document);(function(a,f,m,q){function h(d,b){this.el=d;this.$el=a(d);this.templates=f.MediumInsert.Templates;this.core=this.$el.data("plugin_mediumInsert");this.options=a.extend(!0,{},g,b);this._defaults=g;this._name="mediumInsert";this.core.getEditor()&&(this.core.getEditor()._serializePreEmbeds=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize);this.init()}var g={label:'<i class="material-icons">smart_display</i>',placeholder:"Paste a link from YouTube, Vimeo, Loom, Wistia, Vidyard, Instagram or 100+ other apps and press Enter",captions:!0,captionPlaceholder:"Type caption (optional)",storeMeta:!1,styles:{wide:{label:'<span class="fa fa-align-justify"></span>'},left:{label:'<span class="fa fa-align-left"></span>'},right:{label:'<span class="fa fa-align-right"></span>'}},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var d=a.Event("keydown");d.which=8;a(m).trigger(d)}}},parseOnPaste:!1};h.prototype.init=function(){var d=this.$el.find(".medium-insert-embeds");d.attr("contenteditable",!1);d.each(function(){0===a(this).find(".medium-insert-embeds-overlay").length&&a(this).append(a("<div />").addClass("medium-insert-embeds-overlay"))});this.events();this.backwardsCompatibility()};h.prototype.events=function(){a(m).on("click",a.proxy(this,"unselectEmbed")).on("keydown",a.proxy(this,"removeEmbed")).on("click",".medium-insert-embeds-toolbar .medium-editor-action",a.proxy(this,"toolbarAction")).on("click",".medium-insert-embeds-toolbar2 .medium-editor-action",a.proxy(this,"toolbar2Action"));this.$el.on("keyup click paste",a.proxy(this,"togglePlaceholder")).on("keydown",a.proxy(this,"processLink")).on("click",".medium-insert-embeds-overlay",a.proxy(this,"selectEmbed")).on("mouseenter",".medium-insert-embeds:not(.medium-insert-embeds-active)",a.proxy(this,"mouseenterEmbed")).on("mouseleave",".medium-insert-embeds:not(.medium-insert-embeds-active)",a.proxy(this,"mouseleaveEmbed")).on("contextmenu",".medium-insert-embeds-placeholder",a.proxy(this,"fixRightClickOnPlaceholder"));if(this.options.parseOnPaste)this.$el.on("paste",a.proxy(this,"processPasted"));a(f).on("resize",a.proxy(this,"autoRepositionToolbars"))};h.prototype.backwardsCompatibility=function(){var d=this;this.$el.find(".mediumInsert-embeds").removeClass("mediumInsert-embeds").addClass("medium-insert-embeds");this.$el.find(".medium-insert-embeds").each(function(){0===a(this).find(".medium-insert-embed").length&&(a(this).after(d.templates["src/js/templates/embeds-wrapper.hbs"]({html:a(this).html()})),a(this).remove())})};h.prototype.editorSerialize=function(){var d=this._serializePreEmbeds();a.each(d,function(b){var c=a("<div />").html(d[b].value);c.find(".medium-insert-embeds").removeAttr("contenteditable");c.find(".medium-insert-embeds-overlay").remove();d[b].value=c.html()});return d};h.prototype.add=function(){var d=this.$el.find(".medium-insert-active");if(0!==d.length){var b=d.html().trim();""!==b&&"<br>"!==b&&(b=a('<div class="medium-insert-active"></div>'),d.removeClass("medium-insert-active").after(b),d=b);d.html(this.templates["src/js/templates/core-empty-line.hbs"]().trim());d.is("p")?(d.replaceWith('<div class="medium-insert-active">'+d.html()+"</div>"),d=this.$el.find(".medium-insert-active"),this.core.moveCaret(d)):this.core.moveCaret(d.find("p"));var c=this;d.addClass("medium-insert-embeds medium-insert-embeds-input medium-insert-embeds-active").append(a("<div>").addClass("acceptEmbed").click(function(e){var k=d.text().trim();""===k?d.remove():(e.preventDefault(),e.stopPropagation(),c.options.oembedProxy?c.oembed(k):c.parseUrl(k))})).append(a("<div>").addClass("cancelEmbed").click(function(e){d.remove()}));this.togglePlaceholder({target:d.get(0)});d.find("p").click();this.core.hideButtons()}};h.prototype.togglePlaceholder=function(d){d=a(d.target);var b=f.getSelection();!b||0===b.rangeCount||d.attr("id")&&d.attr("id").startsWith("medium-editor-pastebin-")||(b=b.getRangeAt(0),b=a(b.commonAncestorContainer),b.hasClass("medium-insert-embeds-active")?d=b:b.closest(".medium-insert-embeds-active").length&&(d=b.closest(".medium-insert-embeds-active")),d.hasClass("medium-insert-embeds-active")?(b=d.text().trim(),""===b&&!1===d.hasClass("medium-insert-embeds-placeholder")?(d.addClass("medium-insert-embeds-placeholder").attr("data-placeholder",this.options.placeholder),d.prev("p,div").length?d.css("margin-top","-5px"):d.css("margin-top","")):""!==b&&d.hasClass("medium-insert-embeds-placeholder")&&d.removeClass("medium-insert-embeds-placeholder").removeAttr("data-placeholder")):this.$el.find(".medium-insert-embeds-active").remove())};h.prototype.fixRightClickOnPlaceholder=function(d){this.core.moveCaret(a(d.target))};h.prototype.processLink=function(d){var b=this.$el.find(".medium-insert-embeds-active");if(b.length){var c=b.text().trim();""===c&&-1!==[8,46,13].indexOf(d.which)?b.remove():13===d.which&&(d.preventDefault(),d.stopPropagation(),this.options.oembedProxy?this.oembed(c):this.parseUrl(c))}};h.prototype.processPasted=function(d){var b=d.originalEvent.clipboardData.getData("text");if(a(".medium-insert-embeds-active").length){var c=a(".medium-insert-embeds-active.medium-insert-embeds-placeholder");if(c.length){var e=this;setTimeout(function(){var k=c.find("p");k.text(b);e.core.moveCaret(k,b.length);e.togglePlaceholder({target:k.get(0)});c.find(".acceptEmbed").click()},5)}}};h.prototype.oembed=function(d,b){var c=this;"string"===typeof this.options.oembedProxy?(a.support.cors=!0,a.ajax({crossDomain:!0,cache:!1,url:this.options.oembedProxy,dataType:"json",data:{url:d},success:function(e){var k=e&&e.html;k=k.replace("&img=1","");if(c.options.storeMeta){var l=JSON.stringify(e);l.replace("&controls=2","");l.replace("&img=1","");k+='<div class="medium-insert-embeds-meta"><script type="text/json">'+l+"\x3c/script></div>"}e&&!k&&"photo"===e.type&&e.url&&(k='<img src="'+e.url+'" alt="">');k?b?a.proxy(c,"embed",k,d)():a.proxy(c,"embed",k)():a.proxy(c,"convertBadEmbed",d)()},error:function(e,k,l){a:{try{var n=JSON.parse(e.responseText);break a}catch(p){}n=void 0}"undefined"!==typeof f.console?f.console.log(n&&n.error||e.status||l.message):f.alert("Error requesting media from "+c.options.oembedProxy+" to insert: "+l+" (response status: "+e.status+")");a.proxy(c,"convertBadEmbed",d)()}})):a.isFunction(this.options.oembedProxy)&&this.options.oembedProxy.call(c,d,b)};h.prototype.parseUrl=function(d,b){if(!/youtube|youtu.be|vimeo|instagram|twitter|facebook/.test(d))return a.proxy(this,"convertBadEmbed",d)(),!1;var c=d.replace(/\n?/g,"").replace(/^((http(s)?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/(watch\?v=|v\/)?)([a-zA-Z0-9\-_]+)(.*)?$/,'<div class="video video-youtube"><iframe width="420" height="315" src="//www.youtube.com/embed/$7" frameborder="0" allowfullscreen></iframe></div>').replace(/^https?:\/\/vimeo\.com(\/.+)?\/([0-9]+)$/,'<div class="video video-vimeo"><iframe src="//player.vimeo.com/video/$2" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>').replace(/^https:\/\/twitter\.com\/(\w+)\/status\/(\d+)\/?$/,'<blockquote class="twitter-tweet" align="center" lang="en"><a href="https://twitter.com/$1/statuses/$2"></a></blockquote><script async src="//platform.twitter.com/widgets.js" charset="utf-8">\x3c/script>').replace(/^(https:\/\/www\.facebook\.com\/(.*))$/,'<script src="//connect.facebook.net/en_US/sdk.js#xfbml=1&amp;version=v2.2" async>\x3c/script><div class="fb-post" data-href="$1"><div class="fb-xfbml-parse-ignore"><a href="$1">Loading Facebook post...</a></div></div>').replace(/^https?:\/\/instagram\.com\/p\/(.+)\/?$/,'<span class="instagram"><iframe src="//instagram.com/p/$1/embed/" width="612" height="710" frameborder="0" scrolling="no" allowtransparency="true"></iframe></span>');this.options.storeMeta&&(c+='<div class="medium-insert-embeds-meta"><script type="text/json">'+JSON.stringify({})+"\x3c/script></div>");if(!1===/<("[^"]*"|'[^']*'|[^'">])*>/.test(c))return a.proxy(this,"convertBadEmbed",d)(),!1;b?this.embed(c,d):this.embed(c)};h.prototype.embed=function(d,b){var c=this.$el.find(".medium-insert-embeds-active");if(d){-1<d.indexOf("\x3c/script>")&&(d=a("<div>").attr("data-embed-code",a("<div />").text(d).html()).html(d),d=a("<div>").append(d).html());var e=this.core;if(b){c=this.$el.find(".medium-insert-active, .medium-insert-embeds-active");var k=c.text().replace(b,"");""!==k.trim()?(c.after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:d,url:b})),c.text(k)):c.replaceWith(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:d,url:b}))}else if(b=this.escapeHtml(c.text().trim()),c.is(".medium-insert-embeds-active")){var l=a("<p><br></p>");c.after(l);c.replaceWith(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:d,url:b}));setTimeout(function(){e.moveCaret(l)},5)}else c.after(this.templates["src/js/templates/embeds-wrapper.hbs"]({html:d,url:b}));this.togglePlaceholder({target:c.get(0)});setTimeout(function(){e.triggerInput()},6);-1!==d.indexOf("facebook")&&"undefined"!==typeof FB&&setTimeout(function(){FB.XFBML.parse()},2E3)}else return alert("Incorrect URL format specified"),!1};h.prototype.escapeHtml=function(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};h.prototype.convertBadEmbed=function(d){var b=this.templates["src/js/templates/core-empty-line.hbs"]().trim();var c=this.$el.find(".medium-insert-embeds-active");var e=a(b);c.before(e);c.remove();e.html(d);d=a(b);e.after(d);this.core.triggerInput();this.core.moveCaret(d)};h.prototype.selectEmbed=function(d){var b=this;if(this.core.options.enabled){var c=a(d.target).hasClass("medium-insert-embeds")?a(d.target):a(d.target).closest(".medium-insert-embeds");c.addClass("medium-insert-embeds-selected");setTimeout(function(){b.addToolbar();b.options.captions&&b.core.addCaption(c.find("figure"),b.options.captionPlaceholder)},50)}};h.prototype.unselectEmbed=function(d){var b=a(d.target).hasClass("medium-insert-embeds")?a(d.target):a(d.target).closest(".medium-insert-embeds"),c=this.$el.find(".medium-insert-embeds-selected");if(b.hasClass("medium-insert-embeds-selected")){if(c.not(b).removeClass("medium-insert-embeds-selected"),a(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),this.core.removeCaptions(b.find("figcaption")),a(d.target).is(".medium-insert-caption-placeholder")||a(d.target).is("figcaption"))b.removeClass("medium-insert-embeds-selected"),this.core.removeCaptionPlaceholder(b.find("figure")),setTimeout(function(){b.find("figcaption").focus()},5)}else c.removeClass("medium-insert-embeds-selected"),a(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),a(d.target).is(".medium-insert-caption-placeholder")?(this.core.removeCaptionPlaceholder(b.find("figure")),setTimeout(function(){b.find("figcaption").focus()},5)):!1===a(d.target).is("figcaption")&&this.core.removeCaptions()};h.prototype.mouseenterEmbed=function(d){var b=this;if(this.core.options.enabled){var c=a(d.target).hasClass("medium-insert-embeds")?a(d.target):a(d.target).closest(".medium-insert-embeds");c.hasClass("medium-insert-embeds-selected")||setTimeout(function(){b.addToolbar(c)},50)}};h.prototype.mouseleaveEmbed=function(d){if(this.core.options.enabled){var b=a(d.target).hasClass("medium-insert-embeds")?a(d.target):a(d.target).closest(".medium-insert-embeds");b.hasClass("medium-insert-embeds-selected")||setTimeout(function(){b.find(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove()},50)}};h.prototype.removeEmbed=function(d){if(8===d.which||46===d.which){var b=this.$el.find(".medium-insert-embeds-selected");b.length&&(d.preventDefault(),a(".medium-insert-embeds-toolbar, .medium-insert-embeds-toolbar2").remove(),d=a(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),b.before(d),b.remove(),this.core.hideAddons(),this.core.moveCaret(d),this.core.triggerInput())}};h.prototype.addToolbar=function(d){"undefined"!==typeof d&&d||(d=this.$el.find(".medium-insert-embeds-selected"));var b=!1;if(0!==d.length){this.core.getEditor();a(d).append(this.templates["src/js/templates/embeds-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim());var c=a(".medium-insert-embeds-toolbar");var e=a(".medium-insert-embeds-toolbar2");c.find("button").each(function(){d.hasClass("medium-insert-embeds-"+
a(this).data("action"))&&(a(this).addClass("medium-editor-button-active"),b=!0)});!1===b&&c.find("button").first().addClass("medium-editor-button-active");this.repositionToolbars(d);"undefined"!==typeof initTooltippables&&initTooltippables();c.fadeIn();e.fadeIn()}};h.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars();this.repositionToolbars()}.bind(this),0)};h.prototype.repositionToolbars=function(d){if(this.$el.is(":visible")){"undefined"!==typeof d&&d||(d=this.$el.find(".medium-insert-embeds-selected"));var b=a(".medium-insert-embeds-toolbar"),c=a(".medium-insert-embeds-toolbar2"),e=this.core.getEditor().options.elementsContainer,k=-1<["absolute","fixed"].indexOf(f.getComputedStyle(e).getPropertyValue("position")),l=k?e.getBoundingClientRect():null,n=a(f).width(),p={};c.length&&(p.top=d.offset().top+2,p.left=d.offset().left+d.width()-c.width()-4,k&&(p.top+=e.scrollTop-l.top,p.left-=l.left,n=a(e).width()),p.left+c.width()>n&&(p.left=n-c.width()),c.css(p));b.length&&(p.left=d.offset().left+d.width()/2-b.width()/2,p.top=d.offset().top-b.height()-8-2-5,k&&(p.top+=e.scrollTop-l.top,p.left-=l.left),0>p.top&&(p.top=0),b.css(p))}};h.prototype.toolbarAction=function(d){d=a(d.target).is("button")?a(d.target):a(d.target).closest("button");var b=d.closest("li"),c=b.closest("ul").find("li"),e=this.$el.find(".medium-insert-embeds-selected"),k=this;d.addClass("medium-editor-button-active");b.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active");c.find("button").each(function(){var l="medium-insert-embeds-"+a(this).data("action");a(this).hasClass("medium-editor-button-active")?(e.addClass(l),k.options.styles[a(this).data("action")].added&&k.options.styles[a(this).data("action")].added(e)):(e.removeClass(l),k.options.styles[a(this).data("action")].removed&&k.options.styles[a(this).data("action")].removed(e))});this.core.triggerInput()};h.prototype.toolbar2Action=function(d){var b=a(d.target).is("button")?a(d.target):a(d.target).closest("button");if(b=this.options.actions[b.data("action")].clicked)d=a(d.target).closest(".medium-insert-embeds"),0===d.length&&(d=this.$el.find(".medium-insert-embeds-selected")),b(d);this.core.triggerInput()};a.fn.mediumInsertEmbeds=function(d){return this.each(function(){a.data(this,"plugin_mediumInsertEmbeds")||a.data(this,"plugin_mediumInsertEmbeds",new h(this,d))})}})(jQuery,window,document);(function(a,f,m,q,h){function g(b,c){this.el=b;this.$el=a(b);this.$currentImage=null;this.templates=f.MediumInsert.Templates;this.core=this.$el.data("plugin_mediumInsert");this.options=a.extend(!0,{},d,c);this._defaults=d;this._name="mediumInsert";this.options.preview&&!f.FileReader&&(this.options.preview=!1);this.core.getEditor()&&(this.core.getEditor()._serializePreImages=this.core.getEditor().serialize,this.core.getEditor().serialize=this.editorSerialize);this.init()}var d={label:'<i class="material-icons">image</i>',deleteMethod:"POST",deleteScript:"delete.php",preview:!0,captions:!0,parseOnPaste:!1,captionPlaceholder:"Type caption for image (optional)",autoGrid:3,fileUploadOptions:{url:null,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i},fileDeleteOptions:{},styles:{},actions:{remove:{label:'<span class="fa fa-times"></span>',clicked:function(){var b=a.Event("keydown");b.which=8;a(m).trigger(b)}}},sorting:function(){var b=this;a(".medium-insert-images").sortable({group:"medium-insert-images",containerSelector:".medium-insert-images",itemSelector:"figure",placeholder:'<figure class="placeholder">',handle:"img",nested:!1,vertical:!1,delay:500,afterMove:function(){b.core.triggerInput()}})},messages:{acceptFileTypesError:"This file is not in a supported format: ",maxFileSizeError:"This file is too big: "}};g.prototype.init=function(){var b=this.$el.find(".medium-insert-images");b.find("figcaption").attr("contenteditable",!0);b.find("figure").attr("contenteditable",!1);this.events();this.backwardsCompatibility();this.sorting()};g.prototype.events=function(){a(m).on("click",a.proxy(this,"unselectImage")).on("keydown",a.proxy(this,"removeImage")).on("click",".medium-insert-images-toolbar .medium-editor-action",a.proxy(this,"toolbarAction")).on("click",".medium-insert-images-toolbar2 .medium-editor-action",a.proxy(this,"toolbar2Action"));if(this.options.parseOnPaste){var b=this;this.$el.on("paste",a.proxy(this,"processPasted")).on("keydown",function(c){c=c||f.event;var e=c.which||c.keyCode,k=(c.ctrlKey?c.ctrlKey:17===e?!0:!1)||c.metaKey;if(86==e&&k)try{b.processPasted(c)}catch(l){}})}this.$el.on("click",".medium-insert-images img",a.proxy(this,"selectImage"));a(f).on("resize",a.proxy(this,"autoRepositionToolbars"))};g.prototype.processPasted=function(b){if((b=b.dataTransfer?b.dataTransfer.files:b.originalEvent.clipboardData?b.originalEvent.clipboardData.files:null)&&1<=b.length)return this.add(b),!1};g.prototype.backwardsCompatibility=function(){this.$el.find(".mediumInsert").removeClass("mediumInsert").addClass("medium-insert-images");this.$el.find(".medium-insert-images.small").removeClass("small").addClass("medium-insert-images-left")};g.prototype.editorSerialize=function(){var b=this._serializePreImages();a.each(b,function(c){var e=a("<div />").html(b[c].value);e.find(".medium-insert-images").find("figcaption, figure").removeAttr("contenteditable");e.find(".medium-insert-images-progress").remove();b[c].value=e.html()});return b};g.prototype.add=function(b){var c=this,e=a(this.templates["src/js/templates/images-fileupload.hbs"]()),k={dataType:"json",add:function(l,n){a.proxy(c,"uploadAdd",l,n)();c.options.fileUploadOptions.uploadAdd&&a.isFunction(c.options.fileUploadOptions.uploadAdd)&&c.options.fileUploadOptions.uploadAdd(n)},done:function(l,n){a.proxy(c,"uploadDone",l,n)();c.options.fileUploadOptions.uploadDone&&a.isFunction(c.options.fileUploadOptions.uploadDone)&&c.options.fileUploadOptions.uploadDone(n.result)}};(new XMLHttpRequest).upload&&(k.progress=function(l,n){a.proxy(c,"uploadProgress",l,n)()},k.progressall=function(l,n){a.proxy(c,"uploadProgressall",l,n)()});e.fileupload(a.extend(!0,{},this.options.fileUploadOptions,k));"undefined"!==typeof b&&b?(0===this.core.$el.find(".medium-insert-active").length&&(k=this.core.$el.children("p:not(.medium-insert-buttons)").last(),k.length&&(k.hasClass("medium-insert-active")||k.addClass("medium-insert-active"),this.core.getEditor().selectElement(k[0]))),e.fileupload("add",{files:b})):e.click()};g.prototype.uploadAdd=function(b,c){var e=this.$el.find(".medium-insert-active"),k=this,l=[],n=c.files[0],p=this.options.fileUploadOptions.acceptFileTypes,t=this.options.fileUploadOptions.maxFileSize,w;p&&!p.test(n.type)?l.push(this.options.messages.acceptFileTypesError+n.name):t&&n.size>t&&l.push(this.options.messages.maxFileSizeError+
n.name);0<l.length?this.options.uploadFailed&&"function"===typeof this.options.uploadFailed?this.options.uploadFailed(l,c):alert(l.join("\n")):(this.core.hideButtons(),l=e.html().trim(),""!==l&&"<br>"!==l?(l=a('<div class="medium-insert-active"></div>'),e.removeClass("medium-insert-active").after(l),e=l):e.is("p")&&(e.replaceWith('<div class="medium-insert-active">'+e.html()+"</div>"),e=this.$el.find(".medium-insert-active")),e.next().is("p")||e.after("<p><br></p>"),this.core.moveCaret(e.next()),e.addClass("medium-insert-images"),!1===this.options.preview&&0===e.find("progress").length&&(new XMLHttpRequest).upload&&e.append(this.templates["src/js/templates/images-progressbar.hbs"]()),(c.autoUpload||!1!==c.autoUpload&&a(b.target).fileupload("option","autoUpload"))&&c.process().done(function(){if(k.options.preview){w=new FileReader;var A=c.files[0].type;null!=A&&A.includes("gif")?w.onload=function(y){a.proxy(k,"showImage",y.target.result,c)()}:w.onload=function(y){try{var z=new Image;z.src=y.target.result;z.onload=function(){var x=resizeMe(z);c.files[0]=buildResizedFile(x,c.files[0].name);a.proxy(k,"showImage",x,c)()}}catch(x){a.proxy(k,"showImage",x.target.result,c)()}};w.readAsDataURL(c.files[0])}else c.submit()}))};g.prototype.uploadProgressall=function(b,c){!1===this.options.preview&&(b=parseInt(c.loaded/c.total*100,10),c=this.$el.find(".medium-insert-active").find("progress"),c.attr("value",b).text(b),100===b&&c.remove())};g.prototype.uploadProgress=function(b,c){this.options.preview&&(b=100-parseInt(c.loaded/c.total*100,10),c=c.context.find(".medium-insert-images-progress"),c.css("width",b+"%"),0===b&&c.remove())};g.prototype.uploadDone=function(b,c){a.proxy(this,"showImage",c.result.files[0].url,c)();this.core.clean();this.sorting()};g.prototype.showImage=function(b,c){var e=this.$el.find(".medium-insert-images").filter(function(n,p){return 0===a(p).find("figure").length}).first();e.click();var k=this;if(this.options.preview&&c.context){var l=this.getDOMImage();l.onload=function(){c.context.find("img").attr("src",l.src);this.options.uploadCompleted&&this.options.uploadCompleted(c.context,c);k.core.triggerInput()}.bind(this);l.src=b}else c.context=a(this.templates["src/js/templates/images-image.hbs"]({img:b,progress:this.options.preview})).appendTo(e),e.find("br").remove(),this.options.autoGrid&&e.find("figure").length>=this.options.autoGrid&&(a.each(this.options.styles,function(n,p){e.removeClass("medium-insert-images-"+n);p.removed&&p.removed(e)}),e.addClass("medium-insert-images-grid"),this.options.styles.grid.added&&this.options.styles.grid.added(e)),this.options.preview?c.submit():this.options.uploadCompleted&&this.options.uploadCompleted(c.context,c);this.core.triggerInput();return c.context};g.prototype.getDOMImage=function(){return new f.Image};g.prototype.selectImage=function(b){var c=this,e;this.core.options.enabled&&(this.$currentImage=e=a(b.target),this.$el.blur(),e.addClass("medium-insert-image-active"),e.closest(".medium-insert-images").addClass("medium-insert-active"),setTimeout(function(){c.addToolbar();c.options.captions&&c.core.addCaption(e.closest("figure"),c.options.captionPlaceholder)},50))};g.prototype.unselectImage=function(b){var c=a(b.target);b=this.$el.find(".medium-insert-image-active");c.is("img")&&c.hasClass("medium-insert-image-active")?(b.not(c).removeClass("medium-insert-image-active"),a(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),this.core.removeCaptions(c)):(b.removeClass("medium-insert-image-active"),a(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove(),c.is(".medium-insert-caption-placeholder")?(this.core.removeCaptionPlaceholder(b.closest("figure")),setTimeout(function(){c.focus()},5)):!1===c.is("figcaption")?this.core.removeCaptions():setTimeout(function(){c.focus()},5),this.$currentImage=null)};g.prototype.removeImage=function(b){var c=[],e=this.$el.find(".medium-insert-image-active"),k;if(8===b.which||46===b.which){e.length&&c.push(e);if((e=f.getSelection())&&e.rangeCount){var l=e.getRangeAt(0);e=l.commonAncestorContainer;l="#text"===e.nodeName?a(e).parent():a(e);e=u.selection.getCaretOffsets(e).left;8===b.which&&0===e?k=l.prev():46===b.which&&e===l.text().length&&(k=l.next());k&&k.hasClass("medium-insert-images")&&c.push(k.find("img"));(l=u.selection.getSelectionHtml(m))&&a("<div></div>").html(l).find(".medium-insert-images img").each(function(){c.push(a(this))})}if(c.length){for(e=0;e<c.length;e++)if(this.deleteFile(c[e].attr("src")),k=c[e].closest(".medium-insert-images"),c[e].closest("figure").remove(),0===k.find("figure").length){var n=k.next();if(!1===n.is("p")||""!==n.text())n=a(this.templates["src/js/templates/core-empty-line.hbs"]().trim()),k.before(n);k.remove()}this.core.hideAddons();!l&&n&&(b.preventDefault(),this.core.moveCaret(n));a(".medium-insert-images-toolbar, .medium-insert-images-toolbar2").remove();this.core.triggerInput()}}};g.prototype.deleteFile=function(b){};g.prototype.addToolbar=function(){var b=this.$el.find(".medium-insert-image-active").closest(".medium-insert-images"),c=!1;this.core.getEditor();var e=this.templates["src/js/templates/images-toolbar.hbs"]({styles:this.options.styles,actions:this.options.actions}).trim();e=a("<div>").append(e);a(b).append(e.html());e=a(".medium-insert-images-toolbar");var k=a(".medium-insert-images-toolbar2");e.find("button").each(function(){b.hasClass("medium-insert-images-"+a(this).data("action"))&&(a(this).addClass("medium-editor-button-active"),c=!0)});!1===c&&e.find("button").first().addClass("medium-editor-button-active");this.repositionToolbars();e.fadeIn();k.fadeIn()};g.prototype.autoRepositionToolbars=function(){setTimeout(function(){this.repositionToolbars();this.repositionToolbars()}.bind(this),0)};g.prototype.repositionToolbars=function(){if(this.$el.is(":visible")){var b=a(".medium-insert-images-toolbar"),c=a(".medium-insert-images-toolbar2"),e=this.$el.find(".medium-insert-image-active"),k=this.core.getEditor().options.elementsContainer,l=-1<["absolute","fixed"].indexOf(f.getComputedStyle(k).getPropertyValue("position")),n=l?k.getBoundingClientRect():null,p=a(f).width(),t={};c.length&&(t.top=e.offset().top+2,t.left=e.offset().left+e.width()-c.width()-
4,l&&(t.top+=k.scrollTop-n.top,t.left-=n.left,p=a(k).width()),t.left+c.width()>p&&(t.left=p-c.width()),c.css(t));b.length&&(e.closest(".medium-insert-images-grid-active").length&&(e=e.closest(".medium-insert-images-grid-active")),t.top=e.offset().top-b.height()-8-2-5,t.left=e.offset().left+e.width()/2-b.width()/2,l&&(t.top+=k.scrollTop-n.top,t.left-=n.left),0>t.top&&(t.top=0),b.css(t))}};g.prototype.toolbarAction=function(b){var c=this;if(null!==this.$currentImage){b=a(b.target).is("button")?a(b.target):a(b.target).closest("button");var e=b.closest("li");var k=e.closest("ul").find("li");var l=this.$el.find(".medium-insert-active");b.addClass("medium-editor-button-active");e.siblings().find(".medium-editor-button-active").removeClass("medium-editor-button-active");k.find("button").each(function(){var n="medium-insert-images-"+a(this).data("action");a(this).hasClass("medium-editor-button-active")?(l.addClass(n),c.options.styles[a(this).data("action")].added&&c.options.styles[a(this).data("action")].added(l)):(l.removeClass(n),c.options.styles[a(this).data("action")].removed&&c.options.styles[a(this).data("action")].removed(l))});this.core.hideButtons();this.core.triggerInput()}};g.prototype.toolbar2Action=function(b){null!==this.$currentImage&&(b=a(b.target).is("button")?a(b.target):a(b.target).closest("button"),(b=this.options.actions[b.data("action")].clicked)&&b(this.$el.find(".medium-insert-image-active")),this.core.hideButtons(),this.core.triggerInput())};g.prototype.sorting=function(){a.proxy(this.options.sorting,this)()};a.fn.mediumInsertImages=function(b){return this.each(function(){a.data(this,"plugin_mediumInsertImages")||a.data(this,"plugin_mediumInsertImages",new g(this,b))})}})(jQuery,window,document,u.util)});function resizeMe(v){var r=document.createElement("canvas"),u=v.width,a=v.height;u>a?2E3<u&&(a=Math.round(a*=2E3/u),u=2E3):1500<a&&(u=Math.round(u*=1500/a),a=1500);r.width=u;r.height=a;r.getContext("2d").drawImage(v,0,0,u,a);return r.toDataURL()}
function buildResizedFile(v,r){var u=v.split(",")[1];u=atob(u);for(var a=[],f=0;f<u.length;f++)a.push(u.charCodeAt(f));return buildFile([new Uint8Array(a)],r,v.split(",")[0].split(/[:;]/)[1],new Date)}function buildFile(v,r,u,a){v=new Blob(v,{type:u});v.lastModifiedDate=a;v.name=r;return v};